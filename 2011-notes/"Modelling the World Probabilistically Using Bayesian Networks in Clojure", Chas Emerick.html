<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 3.0.2 (195746)"/><meta name="keywords" content="clojure, conference, day2"/><meta name="created" content="2011-11-11 13:32:28 -0600"/><meta name="updated" content="2011-11-14 17:22:50 -0600"/><title>"Modelling the World Probabilistically Using Bayesian Networks in Clojure", Chas Emerick</title></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;">
<div><b><a href="%22Modelling%20the%20World%20Probabilistically%20Using%20Bayesian%20Networks%20in%20Clojure%22,%20Chas%20Emerick.resources/cemerick-modeling-the-world-with-bayesian-networks.pdf">cemerick-modeling-the-world-with-bayesian-networks.pdf</a><br/></b></div>
<div><b><br/></b></div>
Me
<ul>
<li>@cemerick</li>
<li>Clojure full time since 2008</li>
<li>...</li>
</ul>
<br/>
<b>Why Bayesian networks?</b>
<ul>
<li>Lots of modelling options
<ul>
<li>Hand curated, developed via Monte Carlo methods, or both (or other)</li>
</ul>
</li>
<li>No black boxes
<ul>
<li>In contrast with neural networks where the weights mean nothing</li>
<li>Can determine the root causes for individual inferences (why do you think X?)</li>
<li>Can integrate with other systems at any level</li>
</ul>
</li>
<li>Optimisable</li>
</ul>
<b>Books:</b>
<ul>
<li>"Modelling and Reasoning with Bayesion Networks", ...</li>
<li>"Causality", Judea Pearl</li>
<li>"Probability Reasoning in Intelligent Systems", Judea Pearl</li>
</ul>
<b>Domains and Applications</b>
<div>
<ul>
<li>Building incomplete representations of the world and making inferences based on incomplete, erroneous and noisy data
<ul>
<li>Process control</li>
<li>Decision systems</li>
<li>Prediction</li>
<li>Classification</li>
</ul>
</li>
<li>Document analysis
<ul>
<li>e.g., SEC filings</li>
<li>variety of ad-hoc formats, systematically extract data from them</li>
</ul>
</li>
</ul>
<b>How</b><br/>
<ul>
<li>Select features (random variables)
<ul>
<li>e.g., wet, rain, season, sprinkler</li>
</ul>
</li>
<li>Appeal to logic
<ul>
<li>Truth tables</li>
<li>...</li>
</ul>
</li>
<li>Sometimes logic isn't enough</li>
<li>Joint probability distribution
<ul>
<li>For each combination of values (in the truth table), determine the probability</li>
<li>This can be used to determine P(A|B)</li>
</ul>
</li>
</ul>
<b>(Bayesian) Probability in 1 Minute</b></div>
<ul>
<li>P(wet|spring) = (P(spring|wet) * P(wet)) / P(spring)</li>
</ul>
<b>JPDs don't scale</b>
<ul>
<li>4 random variables -> 16 worlds</li>
<li>m^n worlds (m number of states, n random variables)</li>
<li>{spring, wet, sprinkler, rain} -> 2^4 = 16 worlds</li>
<li>20 vars x 3 states -> 3.487e9 worlds</li>
<li>Need a better representations</li>
</ul>
<b>Bayesian Network</b>
<ul>
<li>Directed acyclic graph of random variables showing a model of dependencies, network build by hand?
<ul>
<li>i.e., you know that rain is likely to make the lawn wet not that a wet lawn is likely to make it rain</li>
</ul>
</li>
<li>Each node has its own probability table constructed with knowledge of what its parent is</li>
<li>O(n log_m(p))! That's good.</li>
</ul>
<b>Where's the f#&amp;@£! Clojure?</b>
<div><b><br/></b></div>
<div><b>Raposo<br/></b>
<ul>
<li>Clojure library for Bayesian inference and modelling</li>
<li>Reimplementation / extraction from existing application</li>
<li>Clojure-idiomatic treatment of data</li>
<li>Learning vehicle</li>
<li>Data:
<ul>
<li>[#{:rain :wet} #{:rain} #{:sprinkler :wet} #{:rain :wet} #{:sprinkler} ...]</li>
<li>(defprotocol Observed<br/>
    (features [this])<br/>
    (value [this feature-name]))</li>
<li>(extend-protocol Observed<br/>
    clojure.lang.IPersistentSet<br/>
    ...)</li>
</ul>
</li>
<li>Modelling the world:
<ul>
<li>Basically:<br/>
<ul>
<li>(def model (create-model {:rain #{:wet}<br/>
                                      :spring #{:rain :sprinkler}<br/>
                                      :sprinkler #{:wet}<br/>
                                      :wet}<br/></li>
<li>...</li>
</ul>
</li>
<li>Monte Carlo methods aswell:
<ul>
<li>(def model (create-model [... probabilities ...] ...))<br/></li>
<li>...</li>
</ul>
</li>
</ul>
</li>
<li>Query
<ul>
<li>=> (probability-of :wet model [{:rain 0.9 :sprinkler 0.6}])<br/>
      0.84...</li>
<li>=> (probability-of :wet model [{:sprinkler false}])<br/>
      0.48...<br/></li>
<li>=> (probability-of :rain model [{:wet true :sprinkler true}])<br/>
...<br/></li>
</ul>
</li>
</ul>
<b>Raposo TODO</b></div>
<div>
<ul>
<li>Release</li>
<li>Expose network learning / generation</li>
<li>Optimisation
<ul>
<li>Elision of independent random variables</li>
<li>Compilation
<ul>
<li>Bayesian network => Clojure</li>
</ul>
</li>
</ul>
</li>
<li>Integrate with core.logic</li>
</ul>
<b>Questions</b></div>
<ul>
<li>Were Bayesian networks an area of general interest or was it specific to this problem?
<ul>
<li>No mostly just for this problem</li>
</ul>
</li>
<li><br/></li>
</ul>
</body></html>