<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 3.0.2 (195746)"/><meta name="keywords" content="clojure, conference, day2"/><meta name="created" content="2011-11-11 10:53:54 -0500"/><meta name="updated" content="2011-11-14 18:24:29 -0500"/><title>"Extending JavaScript Libraries from ClojureScript", Kevin Lynagh</title></head><body style="word-wrap: break-word; -webkit-nbsp-mode: space; -webkit-line-break: after-white-space;">
<div><a href="%22Extending%20JavaScript%20Libraries%20from%20ClojureScript%22,%20Kevin%20Lynagh.resources/kevin-lynagh-clojurescript-javascript-interop.pdf">kevin-lynagh-clojurescript-javascript-interop.pdf</a><br/></div>
<div><a href="%22Extending%20JavaScript%20Libraries%20from%20ClojureScript%22,%20Kevin%20Lynagh.resources/kevin-lynagh-clojurescript-javascript-interop-handout.pdf">kevin-lynagh-clojurescript-javascript-interop-handout.pdf</a><b><br/></b>
<div><b><br/></b></div>
Background
<div>
<ul>
<li>Found that:
<ol>
<li>Clojure is simpler than JavaScript</li>
<li>Using JS from ClojureScript is moar extendable than using JavaScript </li>
<li>.js -> .cljs is an adventure!</li>
</ol>
</li>
<li>Consider Imperial :: Metric -> JavaScript :: Clojure</li>
</ul>
<b>Let's Talk About JS</b></div>
<div><b><br/></b></div>
<div><b>1. Clojure is Simpler Than JavaScript<br/></b></div>
<ul>
<li>"JS has a lot of stupid in it!", Brendan Eigh, creator of JavaScript, news at 11<br/></li>
<li>What terrifies you about JavaScript?
<ul>
<li>The way the JavaScript defines variable scope etc.
<ul>
<li>Attack of the killer globals
<ul>
<li>var x = 12; vs. x = 12;</li>
</ul>
</li>
<li>JavaScript programs tend to live in the browser alongside lots of other programs</li>
<li>Clojure solution: things don't change!</li>
</ul>
</li>
<li>JavaScript Namespaces
<ul>
<li>(function () { ... })(); 
<ul>
<li>module pattern is all we have! </li>
<li>required to isolate your code from others</li>
<li>this is crazy!</li>
</ul>
</li>
<li>Clojure solution: use Clojure namespaces
<ul>
<li>Never going to make it to the top of Hacker News because it is so boring</li>
<li>But that's a good thing, it should be boring</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>CoffeeScript will not save you!<br/></li>
<li>So, Clojure is simpler than JavaScript</li>
<li>Myth: Only Geniuses use Functional Languages</li>
</ul>
<b>2. Using JS from ClojureScript is More Extendable</b>
<ul>
<li>Interop review
<ul>
<li>(. js/console log "hello")</li>
<li>(.log js/console log "hello")</li>
</ul>
</li>
<li>One difference
<ul>
<li>(.aMethod js/anObject)</li>
<li>(. js/anObject (aMethod))</li>
</ul>
</li>
<li>Types:
<ul>
<li>Scalars are all native
<ul>
<li>CLJS string are JS string</li>
<li>CLJS numbers are JS numbers</li>
</ul>
</li>
<li>Collections are foreign (lazy in CLJS)</li>
</ul>
</li>
<li>JS objects</li>
<li>Reader literals</li>
<li>Compare
<ul>
<li>jQuery.select("#main").append("&lt;span>").text("hello);</li>
<li>(-> js/jQuery (. select "#main") (.append "&lt;span>") (.text "hello"))</li>
</ul>
</li>
<li>The Clojure style is easy to extend as you can insert your own functions into the method call chain:
<ul>
<li>(-> js/jQuery (. select "#main") (.append "&lt;span>") <i>(my-append "&lt;blah>")</i> (.text "hello"))<br/></li>
</ul>
</li>
<li>The JS way:
<ul>
<li>Break the chain and call your own function</li>
<li>Or add a "plugin" -> jQuery.fn.my_appender = function(x) {}</li>
<li>End up building facades</li>
</ul>
</li>
<li>e.g., 
<ul>
<li>(defn append [sel node-type] (.append sel node-type))</li>
<li>(defn select [sel selector] (.select sel selector))</li>
<li>(-> js/jQuery (select ...) (append ...))</li>
</ul>
</li>
<li>So, using JS from ClojureScript is
<ul>
<li>more fun</li>
<li>more safe</li>
<li>more extendable</li>
</ul>
</li>
</ul>
<b>3. What we thought we knew until ClojureScript showed us otherwise</b>
<ul>
<li>Let's talk about <i>this</i>
<ul>
<li>var f = function () { return this; }</li>
<li>f(); // -> DOMWindow</li>
<li>var dog = {};</li>
<li>dog.name = "Rex";</li>
<li>dog.bark = function() {return this.name;};</li>
<li>dog.bark // -> Rex</li>
</ul>
</li>
<li>Beware apply!
<ul>
<li>(apply (. js/dog bark) 1 2 3)</li>
<li>cljs.core.apply.call(null, dog.bark, cljs.core.Vector.fromArray([1 2 3]));</li>
</ul>
</li>
<li>Referential transparency problems</li>
<li>Free unsolicited advice:
<ul>
<li>Tools don't make the artist</li>
</ul>
</li>
</ul>
<b>Questions</b>
<div>
<ul>
<li>Why D3? (visualisation library)
<ul>
<li>Most other visualisation libraries just give you a menu and you choose from it</li>
<li>D3 allows you to construct your visualisations however you want, rendering everything out in svg</li>
<li><br/>
<br/></li>
</ul>
</li>
</ul>
</div>
</div>
</body></html>